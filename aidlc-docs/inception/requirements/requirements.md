# 테이블오더 서비스 - 요구사항 문서

## Intent Analysis

- **User Request**: 테이블오더 서비스 신규 구축
- **Request Type**: New Project (Greenfield)
- **Scope**: System-wide (고객 UI, 관리자 UI, 서버, 데이터 저장소)
- **Complexity**: Complex (실시간 통신, 인증, 세션 관리, 다중 사용자 유형)

---

## 기술 스택 결정

| 영역 | 기술 | 비고 |
|---|---|---|
| 프론트엔드 | React (SPA) | 고객용 + 관리자용 |
| 백엔드 | Node.js (Express 또는 Fastify) | REST API + SSE |
| 데이터베이스 | SQLite | 로컬 개발 환경용 |
| 배포 환경 | 로컬 개발 환경 | MVP 검증용 |
| 언어 지원 | 고객: 한국어 + 영어 (전환 버튼) / 관리자: 한국어만 | |

---

## 운영 환경 결정

- **매장 모델**: 단일 매장
- **관리자 계정**: seed data로 사전 등록
- **메뉴 이미지**: 외부 URL 직접 입력
- **테이블 규모**: 10개 이하 (소규모 매장)

---

## 기능 요구사항 (Functional Requirements)

### FR-1: 고객용 기능

#### FR-1.1: 테이블 태블릿 자동 로그인 및 세션 관리
- 관리자가 1회 초기 설정 (매장 식별자, 테이블 번호, 테이블 비밀번호)
- 로그인 정보 로컬 저장 후 자동 로그인
- 16시간 세션 유지

#### FR-1.2: 메뉴 조회 및 탐색
- 메뉴 화면이 기본 화면
- 카테고리별 메뉴 분류 및 표시
- 메뉴 상세 정보: 메뉴명, 가격, 설명, 이미지(외부 URL)
- 카테고리 간 빠른 이동
- 카드 형태 레이아웃, 터치 친화적 (최소 44x44px)
- **메뉴 카드 탭 → 바로 장바구니에 1개 추가** (빠른 주문 방식)
- 메뉴 화면에 "주문내역 보기" 버튼 배치 (주문 내역 화면으로 이동)

#### FR-1.3: 장바구니 관리
- **화면 우측 사이드 패널** 형태로 표시
- 메뉴 추가/삭제, 수량 조절
- **수량 0이 되면 자동으로 장바구니에서 삭제**
- 총 금액 실시간 계산
- 장바구니 비우기
- **빈 장바구니 시 주문하기 버튼 비활성화 (disabled)**
- 클라이언트 측 로컬 저장 (새로고침 시 유지)
- 서버 전송은 주문 확정 시에만

#### FR-1.4: 주문 생성
- 주문 내역 최종 확인 후 확정
- **주문 성공: 전체 화면 성공 페이지** (주문 번호 + 주문 내역 요약 표시, 5초 후 메뉴 화면 자동 리다이렉트)
- 주문 성공 시 장바구니 자동 비우기
- 주문 실패: 에러 메시지 표시, 장바구니 유지
- **추가 주문: 특별한 안내 없이 동일 플로우** (새 주문 번호 발급)
- 주문 정보: 매장 ID, 테이블 ID, 메뉴 목록(메뉴명, 수량, 단가), 총 금액, 세션 ID

#### FR-1.5: 주문 내역 조회
- 주문 시간 순 정렬
- 주문별 상세: 주문 번호, 시각, 메뉴/수량, 금액, 상태(대기중/준비중/완료)
- SSE를 통한 주문 상태 실시간 업데이트 (MVP 포함)
- 현재 테이블 세션 주문만 표시

#### FR-1.6: 세션 만료 처리
- **세션 만료 또는 관리자 이용 완료 처리 시: "이용이 종료되었습니다. 직원에게 문의해주세요" 안내 화면 표시**

### FR-2: 관리자용 기능

#### FR-2.1: 매장 인증
- 매장 식별자 + 사용자명 + 비밀번호 입력
- JWT 토큰 기반 인증, 16시간 세션 유지
- 브라우저 새로고침 시 세션 유지
- 비밀번호 bcrypt 해싱
- **로그인 5회 실패 → 5분간 로그인 차단**
- 관리자 계정은 seed data로 사전 등록
- **로그인 후 기본 화면: 실시간 주문 모니터링 대시보드**

#### FR-2.2: 실시간 주문 모니터링
- **상단 탭/네비게이션 바** (주문 모니터링 | 메뉴 관리)
- SSE 기반 실시간 주문 목록 업데이트
- 그리드/대시보드 레이아웃: 테이블별 카드 형태
- **활성/비활성 테이블 시각적 구분 표시**
- 각 테이블 카드: 총 주문액, **최신 주문 5개** 미리보기
- **테이블 카드 클릭 시 사이드 패널로 주문 상세 보기**
- **주문 상태 변경: 순차 버튼 방식** (대기중→준비중→완료, 클릭 시 즉시 다음 상태)
- 신규 주문 시각적 강조
- 2초 이내 주문 표시

#### FR-2.3: 테이블 관리
- **테이블 초기 설정: 관리자 화면에서 수행** (테이블 번호/비밀번호 생성 후, 태블릿에서 입력)
- **주문 삭제: 소프트 삭제** (삭제 플래그 처리, 과거 내역에서 "삭제됨"으로 표시)
- 주문 삭제 시 확인 팝업 → 총 주문액 재계산 → 성공/실패 피드백
- 테이블 세션 처리 (이용 완료 → 주문 내역 과거 이력 이동 → 리셋)
- 과거 주문 내역 조회 (시간 역순, 날짜 필터링)

#### FR-2.4: 메뉴 관리
- 메뉴 CRUD (메뉴명, 가격, 설명, 카테고리, 이미지 URL)
  - **메뉴명: 한국어 + 영어 모두 입력**
  - **설명: 한국어 + 영어 모두 입력**
- **카테고리 CRUD 기능 포함** (카테고리 추가/수정/삭제/순서 조정)
- 카테고리별 조회
- 메뉴 노출 순서 조정
- 필수 필드 및 가격 범위 검증

---

## 비기능 요구사항 (Non-Functional Requirements)

### NFR-1: 성능
- SSE 기반 실시간 통신 (관리자 + 고객 양쪽)
- 주문 접수 후 2초 이내 관리자 화면 표시

### NFR-2: 보안
- JWT 토큰 기반 인증
- 비밀번호 bcrypt 해싱
- 로그인 시도 제한

### NFR-3: 사용성
- 터치 친화적 UI (최소 44x44px 버튼)
- 직관적인 카드 형태 레이아웃

### NFR-5: 다국어 (i18n)
- **고객 화면**: 한국어 + 영어 지원
  - 기본 한국어, 화면 상단 언어 전환 버튼 (🇰🇷/🇺🇸)으로 즉시 전환
  - 메뉴명/설명: 한국어와 영어 모두 등록 (관리자가 양쪽 입력)
  - 통화: 원화(₩)만 표시 (언어와 무관)
  - 주문 상태(대기중/준비중/완료): 선택된 언어에 맞춰 표시 (영어: Pending/Preparing/Completed)
  - 시스템 메시지(에러, 안내 등): 선택된 언어에 맞춰 다국어 처리
- **관리자 화면**: 한국어만

### NFR-4: 데이터 무결성
- 장바구니 로컬 저장 (새로고침 유지)
- 세션 기반 주문 그룹화
- 주문 이력 영구 보존

---

## 제외 사항 (Out of Scope)

- 결제 처리 (카드, 현금, PG사 연동, 영수증, 환불, 포인트/쿠폰)
- 복잡한 인증 (OAuth, SNS 로그인, 2FA)
- 이미지 업로드/리사이징
- 알림 시스템 (푸시, SMS, 이메일, 소리/진동)
- 주방 기능 (주방 전달, 재고 관리)
- 고급 기능 (분석 대시보드, 매출 리포트, 직원 관리, 예약, 리뷰, 다국어)
- 외부 연동 (배달 플랫폼, POS, 소셜 미디어)

---

## MVP 범위 요약

### 고객용
- 테이블 태블릿 자동 로그인 및 세션 관리
- 메뉴 조회 (카테고리별)
- 장바구니 관리 (로컬 저장)
- 주문 생성 (성공 시 5초 표시 후 자동 리다이렉트)
- 주문 내역 조회 (현재 세션, SSE 실시간 상태 업데이트)

### 관리자용
- 매장 인증 (JWT, 16시간 세션, seed data 계정)
- 실시간 주문 모니터링 (그리드 레이아웃, SSE, 활성/비활성 테이블 구분)
- 테이블 관리 (관리자 화면에서 초기 설정, 주문 소프트 삭제, 이용 완료, 과거 내역)
- 메뉴 관리 (CRUD, 카테고리 CRUD, 순서 조정)
